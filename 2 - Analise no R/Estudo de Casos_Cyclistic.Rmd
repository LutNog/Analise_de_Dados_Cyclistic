---
title: "Untitled"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Estudo de casos - Cyclistic - Google Certificado - Analista de Dados

## Cenário

Você é um analista de dados júnior que trabalha na equipe de analistas de marketing da Cyclistic, uma empresa de compartilhamento de bicicletas em Chicago. O diretor de marketing acredita que o sucesso futuro da empresa depende da maximização do número de planos anuais contratados. Portanto, sua equipe quer entender como os ciclistas casuais e os membros anuais usam as bicicletas da Cyclistic de forma diferente. A partir desses insights, sua equipe criará uma nova estratégia de marketing para converter passageiros casuais em membros anuais. Mas, primeiro, os executivos da Cyclistic devem aprovar suas recomendações que, portanto, devem ser apoiadas com insights de dados convincentes e visualizações de dados profissionais.

## Personagens e equipes

● Cyclistic: Um programa de compartilhamento de bicicletas que conta com mais de 5.800 bicicletas e 600 estações de compartilhamento. A Cyclistic se diferencia por também oferecer bicicletas reclináveis, triciclos manuais e bicicletas de carga, tornando o compartilhamento de bicicletas mais inclusivo para pessoas com deficiência e ciclistas que não podem usar uma bicicleta padrão de duas rodas. A maioria dos ciclistas opta por bicicletas tradicionais; cerca de 8% dos motociclistas usam as opções assistivas. Os usuários da Cyclistic são mais propensos a pedalar por lazer, mas cerca de 30% utilizam as bicicletas para se deslocarem ao trabalho diariamente. ● Lily Moreno: Diretora de marketing e sua gerente. Lily é responsável pelo desenvolvimento de campanhas e iniciativas de promoção do programa de compartilhamento de bicicletas. As campanhas podem incluir e-mail, mídias sociais e outros canais. ● Equipe de análise de marketing da Cyclistic: Uma equipe de analistas de dados responsáveis por coletar, analisar e relatar dados que ajudam a orientar a estratégia de marketing da Cyclistic. Você se juntou a essa equipe há seis meses e tem estado ocupado aprendendo sobre a missão e os objetivos de negócios da Cyclistic -- e como você, como analista de dados júnior, também pode ajudar a Cyclistic a alcançá-los. ● Equipe executiva da Cyclistic: A equipe executiva notoriamente detalhista decidirá se aprova o programa de marketing recomendado.

## Perguntar

Três perguntas nortearão o futuro programa de marketing: 1. Como os membros anuais e os ciclistas casuais usam as bicicletas da Cyclistic de forma diferente? 2. Por que os passageiros casuais iriam querer adquirir planos anuais da Cyclistic? 3. Como a Cyclistic pode usar a mídia digital para influenciar os passageiros casuais a se tornarem membros?

Abaixo segue análise de dados feita para o estudo de caso.

## Carregando os Dados e Bibliotecas

```{r cars, echo=TRUE, message=FALSE, warning=FALSE}
## Carregando as bibliotecas ##
library(tidyverse)
library(readxl)
library(dplyr)
library(ggplot2)
library(tidyr)
library(lubridate)
library(skimr)
library(readr)
```

```{r 1, message=FALSE, warning=FALSE, include=FALSE}
## Carregando arquivos xlsx.
cyclistic_01 <- read_xlsx("/Users/Luk/Desktop/Estudo de Caso 1/1 - Análise - Planilhas Excel/Dados Manipular/2021-10-Cyclistic.xlsx")
cyclistic_02 <- read_xlsx("/Users/Luk/Desktop/Estudo de Caso 1/1 - Análise - Planilhas Excel/Dados Manipular/2021-11-Cyclistic.xlsx")
cyclistic_03 <- read_xlsx("/Users/Luk/Desktop/Estudo de Caso 1/1 - Análise - Planilhas Excel/Dados Manipular/2021-12-Cyclistic.xlsx")
cyclistic_04 <- read_xlsx("/Users/Luk/Desktop/Estudo de Caso 1/1 - Análise - Planilhas Excel/Dados Manipular/2022-01-Cyclistic.xlsx")
cyclistic_05 <- read_xlsx("/Users/Luk/Desktop/Estudo de Caso 1/1 - Análise - Planilhas Excel/Dados Manipular/2022-02-Cyclistic.xlsx")
cyclistic_06 <- read_xlsx("/Users/Luk/Desktop/Estudo de Caso 1/1 - Análise - Planilhas Excel/Dados Manipular/2022-03-Cyclistic.xlsx")
cyclistic_07 <- read_xlsx("/Users/Luk/Desktop/Estudo de Caso 1/1 - Análise - Planilhas Excel/Dados Manipular/2022-04-Cyclistic.xlsx")
cyclistic_08 <- read_xlsx("/Users/Luk/Desktop/Estudo de Caso 1/1 - Análise - Planilhas Excel/Dados Manipular/2022-05-Cyclistic.xlsx")
cyclistic_09 <- read_xlsx("/Users/Luk/Desktop/Estudo de Caso 1/1 - Análise - Planilhas Excel/Dados Manipular/2022-06-Cyclistic.xlsx")
cyclistic_10 <- read_xlsx("/Users/Luk/Desktop/Estudo de Caso 1/1 - Análise - Planilhas Excel/Dados Manipular/2022-07-Cyclistic.xlsx")
cyclistic_11 <- read_xlsx("/Users/Luk/Desktop/Estudo de Caso 1/1 - Análise - Planilhas Excel/Dados Manipular/2022-08-Cyclistic.xlsx")
cyclistic_12 <- read_xlsx("/Users/Luk/Desktop/Estudo de Caso 1/1 - Análise - Planilhas Excel/Dados Manipular/2022-09-Cyclistic.xlsx")
```

```{r message=FALSE, warning=FALSE}
## Analisando os tipos de dados
str(cyclistic_01)
str(cyclistic_02)
str(cyclistic_06)
str(cyclistic_12)
```

## Limpeza e Tratamento dos Dados

```{r}
## Convertendo os dados no mesmo tipo(chr) ##
cyclistic_12 <- mutate(cyclistic_12, end_station_id = as.character(end_station_id))
```

```{r}
## Juntado os dados em um único data frame
cyclistic <- bind_rows(cyclistic_01, cyclistic_02, cyclistic_03, cyclistic_04, cyclistic_05, cyclistic_06, cyclistic_07, cyclistic_08, cyclistic_09, cyclistic_10, cyclistic_11, cyclistic_12)
```

```{r}
## Analisando os tipos de dados do df cyclistic ##
str(cyclistic)
```

```{r}
## Analisando quantas linhas existem nos dados ##
nrow(cyclistic)
```

```{r}
## Analisando as dimensões dos dados ##
dim(cyclistic)
```

```{r}
## Verificando as seis primeiras linhas ##
head(cyclistic)
```

```{r}
## Verificando as seis primeiras linhas ##
head(cyclistic)
```

```{r}
## Verificando o sumário dos dados - cyclistic ##
skim_without_charts(cyclistic)
```

```{r}
## Criando um novo nome para o df e nova coluna para Calcular a duração de horas por passeio ##
cycli <- cyclistic %>%
  mutate(duracao_passeio = difftime(ended_at, started_at, units = "hours"))
```

```{r}
## Selecionado colunas para análise ##
cycli <- cycli %>%
  select(ride_id, rideable_type, started_at, ended_at, duracao_passeio, dia_da_semana, start_station_name, end_station_name, member_casual)

```

```{r}
## verificando os dados do df cycli ##
str(cycli)
```

```{r}
## verificando o sumário dos dados - cycli ##
skim(cycli)
```

```{r}
## Renomear colunas - cycli ##
cycli <- cycli %>%
  rename(id_aluguel=ride_id, tipo_bike=rideable_type, tipo_membro=member_casual,
         nome_estacao_final=end_station_name, nome_estacao_inicial=start_station_name)
```

```{r}
## Inserido dia da semana e transformando duracao_passeio em númerico ##
cycli <- cycli %>%
  mutate(dia = wday(started_at, label = TRUE))%>%
  mutate(duracao_passeio = as.double(duracao_passeio))%>%
  mutate(cycli, duracao_passeio = as.double(duracao_passeio))
```

## Análise Descritiva

```{r echo=TRUE}
## Analisando os dados estatísticos de duração de passeio ##
skim(cycli$duracao_passeio)
```

```{r}
## Analisando a média, mediana, máximo e minimo de duração de passeio por membros ##
aggregate(cycli$duracao_passeio ~ cycli$tipo_membro, FUN = mean)
```

```{r}
aggregate(cycli$duracao_passeio ~ cycli$tipo_membro, FUN = median)
```

```{r}
aggregate(cycli$duracao_passeio ~ cycli$tipo_membro, FUN = max)
```

```{r}
aggregate(cycli$duracao_passeio ~ cycli$tipo_membro, FUN = min)
```

```{r}
## Analisando a média de duração de passeio nos dias da semana por membros ##
aggregate(cycli$duracao_passeio ~ cycli$tipo_membro + cycli$dia_da_semana, FUN = mean)
```

```{r}
## Analisando o máximo de duração de passeio nos dias da semana por membros ##
aggregate(cycli$duracao_passeio ~ cycli$tipo_membro + cycli$dia_da_semana, FUN = max)
```

## Visualização dos Dados

You can also embed plots, for example:

```{r, echo=FALSE}
## Analisando a quantidade total de passeio por membros e dia da semana ##
cycli %>%
  mutate(dia = wday(started_at, label = TRUE)) %>% 
  group_by(tipo_membro, dia) %>% 
  summarise(Total = sum(duracao_passeio)) %>%
  arrange(dia)%>%
  ggplot(aes(x = dia, y = Total , fill = tipo_membro)) + geom_col(position = "dodge") + labs(title = "Cyclistic: Duracação de passeio X dia da semana e tipo de membro", x ="Dia da semana", y = "Total Duração Passeio")

```

```{r, echo=FALSE}
## Analisando o total de passeio por bicicleta ##
cycli %>%
  group_by(tipo_bike) %>% 
  summarise(Total = sum(duracao_passeio))%>%
  ggplot(aes(x = fct_reorder(tipo_bike, Total), y = Total)) + geom_col( fill = "dark green")+ labs(title = "Cyclistic: Tipo de biciclieta X Duracação de Passeio", x ="Tipo de Bicicleta", y = "Total Duração Passeio")
```

```{r, echo=FALSE}

## Analisando qual é o tipo de bicicleta mais utilizado por membros ##
cycli %>%
  group_by(tipo_bike, tipo_membro) %>% 
  summarise(Total = sum(duracao_passeio))%>%
  ggplot(aes(x = tipo_bike, y = Total , fill = tipo_membro)) + geom_col(position = "dodge")+ labs(title = "Cyclistic: Tipo de Biciclieta X Total de Duração de passeio por membro", y = "Total Duração Passeio", X = "Tipo de Bicicleta" )
```

```{r, echo=FALSE}

## Analisando a quantidade total VS aluguel por dia ##
cycli %>%
  mutate(dia = wday(started_at, label = TRUE)) %>%
  group_by(tipo_membro, dia) %>%
  count()%>%
  arrange(dia)%>%
  ggplot(aes(x = dia, y = n , fill = tipo_membro)) + geom_col(position = "dodge")+ labs(title = "Cyclistic: Aluguel de Bicicleta X Uso por membro nos dias da Semana", y = "Total Quantidade de Uso", X = "Dia da semana")
```

```{r, echo=FALSE}

## Analisando a quantidade de alguel por mês e tipo de membro ##
cycli%>%
  mutate(mes = month(started_at, label = TRUE))%>%
  group_by(mes, tipo_membro)%>%
  count(tipo_membro)%>%
  arrange(mes)%>%
  ggplot(aes(x=mes, y=n, fill = tipo_membro)) + geom_col(position = "dodge")+ labs(title = "Cyclistic: Tipo de Membro X Total de aluguel por mês", y="Total Aluguel", x ="Mês")
```

```{r, echo=FALSE}

## Analisando a duração de passeio por mês e tipo de membro ##
cycli%>%
  mutate(mes = month(started_at, label = TRUE))%>%
  group_by(mes, tipo_membro)%>%
  summarise(Total_duracao_passeio = sum(duracao_passeio))%>%
  ggplot(aes(x=mes, y=Total_duracao_passeio, fill = tipo_membro)) + geom_col(position = "dodge")+ labs(title = "Cyclistic: Tipo de Membro vs Total Duração de passeio por mês", y="Total Duração Passeio", x ="Mês")
```

```{r, echo=FALSE}

## Analisando Outliers ##
cycli%>%
  ggplot(aes(x=tipo_membro, y=duracao_passeio)) + geom_boxplot(ymax = 200)+ labs(title = "Cyclistic: Boxplot Tipo de membro vs Total de duração de passeio", y="Total duração passeio", x ="Mês")
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
